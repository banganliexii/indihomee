// Membership Packages Data (ID & EN)
const packagesData = {
  id: [
    {
      icon: "icon-digital.png",
      name: "Paket Digital Jitu 1",
      speed: "30 / 50 / 100 Mbps",
      price: "Mulai dari Rp265.000/bulan",
      desc: "Cocok untuk rumah kecil & streaming santai",
      cta: "Daftar Sekarang",
      link: "https://wa.me/6289637100670?text=Saya+ingin+langganan+Digital+Jitu+1",
    },
    {
      icon: "icon-dynamic.png",
      name: "Paket Dynamic 1P",
      speed: "50–300 Mbps",
      price: "Mulai dari Rp370.000/bulan",
      desc: "Termasuk paket suara & SMS. Ideal untuk rumah aktif & gamer",
      cta: "Konsultasi Gratis",
      link: "https://wa.me/6289637100670?text=Saya+ingin+info+Dynamic+1P",
    },
    {
      icon: "icon-movie.png",
      name: "Paket Movie 1P",
      speed: "30–100 Mbps",
      price: "Mulai dari Rp379.000/bulan",
      desc: "Gratis Netflix + Disney+ Hotstar. Untuk pecinta film",
      cta: "Daftar Sekarang",
      link: "https://wa.me/6289637100670?text=Saya+ingin+langganan+Movie+1P",
    },
    {
      icon: "icon-complete.png",
      name: "Paket Complete 1P",
      speed: "50–100 Mbps",
      price: "Mulai dari Rp405.000/bulan",
      desc: "Berbagi data keluarga + suara & SMS. Pas untuk keluarga besar",
      cta: "Konsultasi Gratis",
      link: "https://wa.me/6289637100670?text=Saya+ingin+info+Complete+1P",
    },
  ],
  en: [
    {
      icon: "icon-digital.png",
      name: "Digital Jitu 1 Package",
      speed: "30 / 50 / 100 Mbps",
      price: "Starts from Rp265,000/month",
      desc: "Ideal for small homes & casual streaming",
      cta: "Register Now",
      link: "https://wa.me/6289637100670?text=I+want+to+subscribe+Digital+Jitu+1",
    },
    {
      icon: "icon-dynamic.png",
      name: "Dynamic 1P Package",
      speed: "50–300 Mbps",
      price: "Starts from Rp370,000/month",
      desc: "Includes voice & SMS. Perfect for active homes & gamers",
      cta: "Free Consultation",
      link: "https://wa.me/6289637100670?text=I+want+info+Dynamic+1P",
    },
    {
      icon: "icon-movie.png",
      name: "Movie 1P Package",
      speed: "30–100 Mbps",
      price: "Starts from Rp379,000/month",
      desc: "Free Netflix + Disney+ Hotstar. For movie lovers",
      cta: "Register Now",
      link: "https://wa.me/6289637100670?text=I+want+to+subscribe+Movie+1P",
    },
    {
      icon: "icon-complete.png",
      name: "Complete 1P Package",
      speed: "50–100 Mbps",
      price: "Starts from Rp405,000/month",
      desc: "Family data sharing + voice & SMS. Great for big families",
      cta: "Free Consultation",
      link: "https://wa.me/6289637100670?text=I+want+info+Complete+1P",
    },
  ],
};

// Texts for ID & EN
const texts = {
  id: {
    heroTitle:
      "Internet Cepat, Hiburan Tanpa Batas — Pilih Paket IndiHome Terbaik untukmu!",
    heroSubtitle:
      "Nikmati koneksi internet stabil berkecepatan tinggi, gratis Disney+ Hotstar, Netflix, IndiHome TV, serta berbagi data keluarga. Daftar sekarang dan rasakan kemudahan langsung terhubung!",
    packagesHeading: "Pilih Paket Internet Sesuai Gaya Hidup Anda",
    benefitHeading: "Keunggulan IndiHome Membership",
    benefit1: "Internet berkecepatan hingga <strong>300 Mbps</strong>",
    benefit2: "Streaming legal: <strong>Disney+ Hotstar & Netflix</strong>",
    benefit3: "IndiHome TV dengan <strong>channel premium</strong>",
    benefit4: "Berbagi data keluarga & <strong>SMS gratis</strong>",
    benefit5: "<strong>Layanan pelanggan 24/7</strong>",
    ctaHeading: "Gabung Sekarang & Nikmati Internet Unlimited di Rumah!",
    faqHeading: "Pertanyaan yang Sering Diajukan",
    testimonialsHeading: "Ulasan Pengguna (Bintang 5)",
    contactFormName: "Nama Anda",
    contactFormPhone: "Nomor Telepon",
    contactFormSelect: "Pilih Paket",
    contactFormBtn: "Klaim Promo Hari Ini",
    faq: [
      {
        q: "Berapa lama proses aktivasi?",
        a: "Aktivasi maksimal 24 jam setelah pendaftaran.",
      },
      {
        q: "Apakah ada biaya pemasangan?",
        a: "Pemasangan gratis selama periode promo.",
      },
      {
        q: "Bagaimana cara pembayaran?",
        a: "Pembayaran via autodebit, transfer bank, atau e-wallet.",
      },
    ],
    testimonials: [
      {
        stars: "★★★★★",
        text: "Internet stabil, streaming Netflix & Disney+ lancar banget. Layanan pelanggan cepat tanggap!",
        reviewer: "— Bapak A",
      },
      {
        stars: "★★★★★",
        text: "Harga masuk akal, pemasangan cepat, cocok untuk keluarga kecil atau besar. Recommended!",
        reviewer: "— Ibu B",
      },
      {
        stars: "★★★★★",
        text: "Saya suka bisa berbagi data keluarga, TV channel premium juga banyak pilihan.",
        reviewer: "— Bapak D",
      },
      {
        stars: "★★★★★",
        text: "Customer service sangat baik dan pemasangan cepat. Cocok untuk keluarga!",
        reviewer: "— Ibu F",
      },
    ],
  },
  en: {
    heroTitle:
      "Fast Internet, Unlimited Entertainment — Choose Your Best IndiHome Package!",
    heroSubtitle:
      "Enjoy stable high-speed internet, free Disney+ Hotstar, Netflix, IndiHome TV, and family data sharing. Sign up now for seamless connection!",
    packagesHeading: "Choose the Internet Package That Fits Your Lifestyle",
    benefitHeading: "IndiHome Membership Advantages",
    benefit1: "Internet speeds up to <strong>300 Mbps</strong>",
    benefit2: "Legal streaming: <strong>Disney+ Hotstar & Netflix</strong>",
    benefit3: "IndiHome TV with <strong>premium channels</strong>",
    benefit4: "Family data sharing & <strong>free SMS</strong>",
    benefit5: "<strong>24/7 customer service</strong>",
    ctaHeading: "Join Now & Enjoy Unlimited Internet At Home!",
    faqHeading: "Frequently Asked Questions",
    testimonialsHeading: "User Reviews (5 Stars)",
    contactFormName: "Your Name",
    contactFormPhone: "Phone Number",
    contactFormSelect: "Choose Package",
    contactFormBtn: "Claim Today’s Promo",
    faq: [
      {
        q: "How long is the activation process?",
        a: "Activation within 24 hours after registration.",
      },
      {
        q: "Is there an installation fee?",
        a: "Installation is free during promo period.",
      },
      {
        q: "How do I pay?",
        a: "Payments via autodebit, bank transfer, or e-wallet.",
      },
    ],
    testimonials: [
      {
        stars: "★★★★★",
        text: "Stable internet, Netflix & Disney+ streaming is super smooth. Responsive customer service!",
        reviewer: "— Mr A",
      },
      {
        stars: "★★★★★",
        text: "Reasonable price, fast installation, perfect for all families. Highly recommended!",
        reviewer: "— Ms B",
      },
      {
        stars: "★★★★★",
        text: "Love the family data sharing, premium TV channels have many choices.",
        reviewer: "— Mr D",
      },
      {
        stars: "★★★★★",
        text: "Customer service is excellent and the installation was fast. Highly recommended for families!",
        reviewer: "— Ms F",
      },
    ],
  },
};

let currentLang = "id";

// Render Package Cards with Local Image Icon and Animation
function renderPackageCards() {
  const packageSlider = document.querySelector(".package-slider");
  if (!packageSlider) return;
  packageSlider.innerHTML = "";

  packagesData[currentLang].forEach((pkg, i) => {
    const card = document.createElement("div");
    card.className = "package-card animate__animated";
    card.setAttribute("tabindex", "0");
    card.setAttribute("aria-label", pkg.name);

    card.style.animationDelay = `${i * 0.15}s`;
    card.classList.add("animate__fadeInUp");

    card.innerHTML = `
      <div class="package-icon bounce-icon" aria-hidden="true">
        <img src="${pkg.icon}" alt="" width="42" height="42" loading="lazy"/>
      </div>
      <h3>${pkg.name}</h3>
      <div class="package-speed">${pkg.speed}</div>
      <div class="package-price">${pkg.price}</div>
      <div class="package-desc">${pkg.desc}</div>
      <a href="${pkg.link}" target="_blank" rel="noopener" aria-label="${pkg.cta} untuk ${pkg.name}">
        <button class="package-cta btn-main ripple">${pkg.cta}</button>
      </a>
    `;
    packageSlider.appendChild(card);
  });

  // Animate icons on mouseover
  packageSlider.querySelectorAll(".bounce-icon").forEach((icon) => {
    icon.addEventListener("mouseenter", () => {
      icon.classList.add("animate__bounce");
    });
    icon.addEventListener("animationend", () => {
      icon.classList.remove("animate__bounce");
    });
  });

  // Ripple effect for buttons
  packageSlider.querySelectorAll(".ripple").forEach((btn) => {
    btn.addEventListener("click", function (e) {
      const circle = document.createElement("span");
      circle.className = "ripple-anim";
      circle.style.left = `${e.offsetX}px`;
      circle.style.top = `${e.offsetY}px`;
      this.appendChild(circle);
      setTimeout(() => circle.remove(), 600);
    });
  });
}

// IMPROVISASI: Render 3 Promo Images (image1, image2, image3) after heading
function renderPromoImages() {
  let promoImagesContainer = document.querySelector(".package-images");
  if (!promoImagesContainer) {
    // Create container if not exists
    promoImagesContainer = document.createElement("div");
    promoImagesContainer.className = "package-images";
    promoImagesContainer.style.display = "flex";
    promoImagesContainer.style.flexWrap = "wrap";
    promoImagesContainer.style.gap = "24px";
    promoImagesContainer.style.justifyContent = "center";
    promoImagesContainer.style.marginBottom = "32px";
    // Insert after paket-heading
    const paketHeading = document.getElementById("paket-heading");
    if (paketHeading && paketHeading.parentNode) {
      paketHeading.parentNode.insertBefore(
        promoImagesContainer,
        paketHeading.nextSibling
      );
    }
  }
  promoImagesContainer.innerHTML = `
    <img src="Paket Dynamic.jpg" alt="Paket Telkomsel One Dynamic" width="50" style="max-width:100%;height:auto;box-shadow:0 2px 8px rgba(0,0,0,0.08);border-radius:5px;" loading="lazy" />
    <img src="Paket EZnet.jpg" alt="Paket EZnet by Telkomsel" width="50" style="max-width:100%;height:auto;box-shadow:0 2px 8px rgba(0,0,0,0.08);border-radius:5px;" loading="lazy" />
    <img src="Paket Indihome Telkomsel.jpg" alt="Paket IndiHome by Telkomsel" width="50" style="max-width:100%;height:auto;box-shadow:0 2px 8px rgba(0,0,0,0.08);border-radius:5px;" loading="lazy" />
  `;
}

// Slider Paket with Smooth Animation
function initPackageSlider() {
  const packageSlider = document.querySelector(".package-slider");
  const leftArrow = document.querySelector(".slider-arrow.left");
  const rightArrow = document.querySelector(".slider-arrow.right");
  if (!packageSlider || !leftArrow || !rightArrow) return;

  const cardWidth = () => {
    const card = packageSlider.querySelector(".package-card");
    return card ? card.offsetWidth + 28 : 260;
  };

  leftArrow.addEventListener("click", () => {
    packageSlider.scrollBy({ left: -cardWidth(), behavior: "smooth" });
    packageSlider.classList.add("slider-bounce-left");
    setTimeout(() => packageSlider.classList.remove("slider-bounce-left"), 400);
  });

  rightArrow.addEventListener("click", () => {
    packageSlider.scrollBy({ left: cardWidth(), behavior: "smooth" });
    packageSlider.classList.add("slider-bounce-right");
    setTimeout(
      () => packageSlider.classList.remove("slider-bounce-right"),
      400
    );
  });

  [leftArrow, rightArrow].forEach((btn) => {
    btn.addEventListener("keydown", (e) => {
      if (e.key === "Enter" || e.key === " ") btn.click();
    });
  });
}

// FAQ Accordion with Slide Animation
function initFAQAccordion() {
  document.querySelectorAll(".faq-question").forEach((btn) => {
    btn.addEventListener("click", function () {
      const item = btn.parentElement;
      const isActive = item.classList.contains("active");
      document.querySelectorAll(".faq-item").forEach((i) => {
        i.classList.remove("active");
        i.querySelector(".faq-answer").style.maxHeight = null;
        i.querySelector(".faq-question").setAttribute("aria-expanded", "false");
      });
      if (!isActive) {
        item.classList.add("active");
        const answer = item.querySelector(".faq-answer");
        answer.style.maxHeight = answer.scrollHeight + "px";
        answer.classList.add("animate__animated", "animate__fadeInDown");
        btn.setAttribute("aria-expanded", "true");
      } else {
        btn.setAttribute("aria-expanded", "false");
      }
    });
    btn.addEventListener("keydown", function (e) {
      if (e.key === "Enter" || e.key === " ") btn.click();
    });
  });
}

// Form Submit ke WhatsApp with Button Animation
function initContactForm() {
  const form = document.getElementById("promoForm");
  if (!form) return;
  form.addEventListener("submit", function (e) {
    e.preventDefault();
    const name = form.elements["name"].value.trim();
    const phone = form.elements["phone"].value.trim();
    const packageName = form.elements["package"].value;

    if (!name || !phone || !packageName) return;

    let waMsg;
    if (currentLang === "id") {
      waMsg = `Halo IndiHome! Saya ${name} (${phone}) ingin klaim promo paket ${packageName}.`;
    } else {
      waMsg = `Hello IndiHome! I am ${name} (${phone}) and want to claim the promo for ${packageName} package.`;
    }
    const waLink = `https://wa.me/6289637100670?text=${encodeURIComponent(
      waMsg
    )}`;
    // Animate button
    const btn = form.querySelector('button[type="submit"]');
    btn.classList.add("animate__animated", "animate__pulse");
    setTimeout(() => btn.classList.remove("animate__pulse"), 600);
    window.open(waLink, "_blank");
  });
}

// Language Switcher
function initLangSwitcher() {
  document.getElementById("lang-id").addEventListener("click", () => {
    if (currentLang !== "id") {
      currentLang = "id";
      rerenderText();
    }
  });
  document.getElementById("lang-en").addEventListener("click", () => {
    if (currentLang !== "en") {
      currentLang = "en";
      rerenderText();
    }
  });
}

// Rerender all text (hero, headings, benefits, CTA, FAQ, testimonials, form)
function rerenderText() {
  document.getElementById("hero-title").innerHTML =
    texts[currentLang].heroTitle;
  document.getElementById("hero-subtitle").innerHTML =
    texts[currentLang].heroSubtitle;
  document.getElementById("paket-heading").innerText =
    texts[currentLang].packagesHeading;
  document.getElementById("benefit-heading").innerText =
    texts[currentLang].benefitHeading;
  document.getElementById("benefit1").innerHTML = texts[currentLang].benefit1;
  document.getElementById("benefit2").innerHTML = texts[currentLang].benefit2;
  document.getElementById("benefit3").innerHTML = texts[currentLang].benefit3;
  document.getElementById("benefit4").innerHTML = texts[currentLang].benefit4;
  document.getElementById("benefit5").innerHTML = texts[currentLang].benefit5;
  document.getElementById("cta-heading").innerText =
    texts[currentLang].ctaHeading;
  document.getElementById("faq-heading").innerText =
    texts[currentLang].faqHeading;
  document.getElementById("testimonials-heading").innerText =
    texts[currentLang].testimonialsHeading;

  // FAQ
  const faqItems = document.querySelectorAll(".faq-item");
  texts[currentLang].faq.forEach((item, idx) => {
    const btn = faqItems[idx].querySelector(".faq-question");
    const ans = faqItems[idx].querySelector(".faq-answer");
    btn.innerText = item.q;
    ans.innerText = item.a;
  });

  // Testimonials
  const testimonials = document.querySelectorAll(".testimonial");
  texts[currentLang].testimonials.forEach((item, idx) => {
    testimonials[idx].querySelector(".stars").innerText = item.stars;
    testimonials[idx].querySelector(
      "figcaption"
    ).innerHTML = `"${item.text}"<br /><span class="reviewer">${item.reviewer}</span>`;
  });

  // Form
  const form = document.getElementById("promoForm");
  if (form) {
    form.elements["name"].placeholder = texts[currentLang].contactFormName;
    form.elements["phone"].placeholder = texts[currentLang].contactFormPhone;
    form.elements["package"].options[0].text =
      texts[currentLang].contactFormSelect;
    form.querySelector("button[type=submit]").innerText =
      texts[currentLang].contactFormBtn;
  }

  // Re-render package cards
  renderPackageCards();

  // Re-render promo images
  renderPromoImages();
}

document.addEventListener("DOMContentLoaded", () => {
  renderPromoImages();
  renderPackageCards();
  initPackageSlider();
  initFAQAccordion();
  initContactForm();
  initLangSwitcher();
});
